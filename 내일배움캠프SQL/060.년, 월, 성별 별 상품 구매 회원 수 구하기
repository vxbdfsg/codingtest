SELECT DATE_FORMAT(SALES_DATE, "%Y") YEARS,
DATE_FORMAT(SALES_DATE, "%m") MONTH,
U.GENDER,
COUNT(DISTINCT U.USER_ID)
FROM USER_INFO U JOIN ONLINE_SALE O on U.USER_ID = O.USER_ID
WHERE U.GENDER is not NULL
GROUP BY YEARS, MONTH, GENDER
ORDER BY YEARS, MONTH, GENDER
