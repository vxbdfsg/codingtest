SELECT DATE_FORMAT(S.SALES_DATE, "%Y") as YEAR, 
DATE_FORMAT(S.SALES_DATE, "%m") as MONTH, 
COUNT(DISTINCT I.USER_ID) as PURCHASED_USERS,
ROUND(COUNT(DISTINCT I.USER_ID)/(SELECT COUNT(*) FROM USER_INFO WHERE JOINED LIKE '2021%'), 1) as PUCHASED_RATIO
FROM USER_INFO I JOIN ONLINE_SALE S on I.USER_ID = S.USER_ID
WHERE I.JOINED LIKE '2021%'
GROUP BY YEAR, MONTH
ORDER BY YEAR, MONTH
